<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Form View -->
    <record id="view_emplo_evalu_form" model="ir.ui.view">
        <field name="name">evalution.employee.goals.form1</field>
        <field name="model">employee.performance.evaluation</field>
        <field name="arch" type="xml">
            <form string="Evaluation Employee Goals">
                <header>
                    <button string="Send" groups='hr_base.group_division_manager' states="draft" class="oe_highlight" type="object" name="send"/>
                    <button string="Accept" states='dir_manager' class="oe_highlight" type="object" name="action_approval"/>
                    <button string="refuse" states='dir_manager' class="oe_highlight" type="object" name="action_refuse"/>

                    <button string="Accept" groups='hr_base.group_department_manager' states='wait_dir_manager' class="oe_highlight" type="object" name="action_approval"/>
                    <button string="refuse" groups='hr_base.group_department_manager' states='wait_dir_manager' class="oe_highlight" type="object" name="action_refuse"/>

                    <button string="Accept" groups='hr.group_hr_user' states='wait_hr_manager' class="oe_highlight" type="object" name="action_approval"/>
                    <button string="refuse" groups='hr.group_hr_user' states='wait_hr_manager' class="oe_highlight" type="object" name="action_refuse"/>
                    <button string="Reset To Draft" states='approve,refuse' class="oe_highlight" type="object" name="reset_draft"/>
                    <field name="state" required="1" statusbar_visible="draft,wait_dir_manager,wait_hr_manager,approve,refuse" widget="statusbar"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field  name="employee_id" required="1"/>
                            <field  name="manager_id" required="1"/>
                            <field  name="department_id" required="1"/>
                            <field  name="job_id" required="1"/>
                        </group>
                        <group>
                            <field  name="date_apprisal"/>
                            <field  name="year_id" required="1"  options='{"no_open": True,"no_create_edit": True,"no_create":True}'/>
                            <field  name="period_goals_id" domain="[('kpi_goal_period_id', '=', year_id),('kpi_period_id','=',False)]"  attrs="{'invisible':[('year_id','=',False)]}" required="1" options='{"no_open": False,"no_create_edit": True,"no_create":True}'/>
                            <field  name="mark_apprisal"  decoration-bf="1" required="1"/>
<!--                            <field  name="total" decoration-bf="1" />-->
                        </group>
                    </group>
                    <notebook>
                        <page string="Employee Goals">
                            <button string="Select Goals" class="oe_highlight" type="object" name="onchange_emp_goal_ids"/>
                            <field name="emp_goal_ids">
                                <tree create="0" delete="0" editable="bottom">
                                    <field  name="kpi_id" width="12" options='{"no_open": False,"no_create_edit": True,"no_create":True}'/>
                                    <field  name="weight" sum="Total Weight" width="12"/>
                                    <field  name="target" sum="Total Target" width="12"/>
                                    <field  name="done" width="12"/>
                                    <field decoration-bf="1" name="mark_evaluation" width="12"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Recommendations">
                            <field widget="html" required="0" name="recommendations"/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <!-- Tree View -->
    <record id="view_evalution_goals_employee_tree1" model="ir.ui.view">
        <field name="name">evalution.employee.goals.tree1</field>
        <field name="model">employee.performance.evaluation</field>
        <field name="arch" type="xml">
            <tree string="Year Employee Goals" decoration-info="state == 'draft'" decoration-danger="state == 'refuse'"  decoration-success="state== 'approve'" >
                <field name="employee_id"/>
                <field name="department_id"/>
                <field name="job_id"/>
                <field name="year_id"/>
                <field name="period_goals_id"/><field name="date_apprisal"/>
                <field name="state" widget="badge" decoration-info="state == 'draft'" decoration-danger="state == 'refuse'"  decoration-success="state== 'approve'"/>
                <field name="mark_apprisal" sum='Total' decoration-bf="1"/>
            </tree>
        </field>
    </record>

    <!-- Menu Action -->
    <record id="action_evalution_goal_emp" model="ir.actions.act_window">
        <field name="name">Evaluation Employee Goals</field>
        <field name="res_model">employee.performance.evaluation</field>
        <field name="view_mode">tree,form</field>
    </record>
    <!-- Menu Item -->
    <menuitem id="menu_evalution_employee_goals_" sequence="2" groups="exp_hr_appraisal.group_appraisal_manager,exp_hr_appraisal.group_appraisal_user,exp_hr_appraisal.group_appraisal_employee" name="Employee Goals Appraisal" parent="exp_hr_appraisal.appraisal_menu_id" action="action_evalution_goal_emp"/>
</odoo>
